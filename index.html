<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Реверсивный инжиниринг и АТ — интенсив (RGSU × STEP_3D)</title>
  <meta name="description" content="Практический интенсив: 3D-сканирование → реверс в CAD → 3D-печать оснастки и мастер-моделей. От кейсов к результату.">
  <meta name="theme-color" content="#ffffff" />
  <meta property="og:title" content="Реверсивный инжиниринг и АТ — интенсив" />
  <meta property="og:description" content="3D-сканирование → реверс в CAD → 3D-печать оснастки. Практика на базе РГСУ." />
  <meta property="og:type" content="website" />
  <link rel="preconnect" href="https://cdn.tailwindcss.com">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          borderRadius: { '2xl': '1rem' },
          boxShadow: { 'soft': '0 6px 24px rgba(0,0,0,.06)', 'soft-md': '0 10px 30px rgba(0,0,0,.08)' }
        }
      }
    }
  </script>
  <style>
html, body { scroll-behavior: smooth; }
.line-clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
.divider { margin: 2rem auto; height: 1px; width: 100%; max-width: 72rem; background-image: linear-gradient(90deg, rgba(0,0,0,0) 0%, rgba(0,0,0,.1) 50%, rgba(0,0,0,0) 100%); }
.reveal { opacity: 0; transform: translateY(8px); transition: opacity .45s ease, transform .45s ease; }
.revealed { opacity: 1 !important; transform: none !important; }
.brand { position: relative; display: grid; place-items: center; height: 4rem; border-radius: .75rem; background: #fff; border: 1px solid rgba(0,0,0,.1); padding: 0 1rem; font-size: .875rem; font-weight: 600; letter-spacing: .02em; color: rgba(0,0,0,.8); }
.brand::after { content: ""; position: absolute; inset: 0; border-radius: .75rem; box-shadow: inset 0 0 0 1px rgba(0,0,0,.1); opacity: 0; transition: .2s ease; }
.brand:hover::after { opacity: 1; }
.dot { height: 6px; border-radius: 999px; transition: width .25s ease, background-color .25s ease, opacity .25s ease; }
.hover-shimmer:hover::after{ content:""; pointer-events:none; position:absolute; inset:0; background: radial-gradient(400px 60px at 0% 0%, rgba(0,0,0,.04), transparent); opacity:1; }
</style>
</head>
<body class="min-h-dvh bg-white text-neutral-900 selection:bg-black selection:text-white">
  <div id="scrollbar" class="fixed left-0 top-0 z-[60] h-0.5 w-full bg-black/80" style="transform-origin:left center; transform:scaleX(0)"></div>
  <header class="sticky top-0 z-50 border-b border-black/10 bg-white/70 backdrop-blur">
    <div class="mx-auto flex max-w-6xl items-center justify-between px-4 py-3">
      <a href="#top" class="font-semibold tracking-tight">4I.R22.01</a>
      <nav class="hidden gap-6 text-sm md:flex" id="navLinks" aria-label="Основная навигация">
        <a href="#about" class="opacity-70 transition hover:opacity-100" data-nav="about">О курсе</a>
        <a href="#program" class="opacity-70 transition hover:opacity-100" data-nav="program">Программа</a>
        <a href="#team" class="opacity-70 transition hover:opacity-100" data-nav="team">Команда</a>
        <a href="#apply" class="opacity-70 transition hover:opacity-100" data-nav="apply">Запись</a>
      </nav>
      <a href="#apply" class="rounded-xl border border-black/10 px-3 py-1.5 text-sm transition hover:bg-black hover:text-white">Поступить</a>
    </div>
  </header>
  <section id="top" class="relative overflow-hidden">
    <div class="mx-auto grid max-w-6xl grid-cols-1 items-center gap-10 px-4 py-16 md:grid-cols-2">
      <div>
        <h1 class="reveal text-4xl font-semibold leading-tight tracking-tight md:text-5xl">Реверсивный инжиниринг<br/>и аддитивное производство</h1>
        <p class="reveal mt-4 text-black/70">Практический интенсив на базе РГСУ: 3D-сканирование → реверс в CAD → печать оснастки и мастер-моделей. От кейсов к результату.</p>
        <div id="benefits" class="mt-6 flex flex-wrap gap-3" aria-label="Преимущества"></div>
        <div class="mt-6 flex items-center gap-6">
          <a href="#apply" class="rounded-xl bg-black px-4 py-2 text-white transition hover:opacity-90">Записаться</a>
          <a href="#program" class="rounded-xl border border-black/10 px-4 py-2 transition hover:bg-black hover:text-white">Смотреть программу</a>
        </div>
        <div class="mt-4 inline-flex items-center gap-3 rounded-2xl border border-black/10 bg-white/70 px-4 py-2 backdrop-blur" aria-live="polite">
          <span class="text-sm">Старт: <span class="font-semibold">20 октября 2025</span></span>
          <span class="text-sm opacity-70">Осталось: <span class="font-medium" id="countdown">—</span></span>
        </div>
        <div id="stats" class="mt-6 grid grid-cols-2 gap-3 sm:grid-cols-4" aria-label="Статистика"></div>
      </div>
      <div class="relative aspect-square rounded-3xl border border-black/10 bg-gradient-to-b from-neutral-50 to-neutral-100 p-2">
        <div id="carousel" class="relative h-full w-full overflow-hidden rounded-2xl select-none" aria-roledescription="карусель"></div>
        <div class="pointer-events-none absolute inset-0 rounded-3xl ring-1 ring-inset ring-black/10"></div>
      </div>
    </div>
  </section>
  <div class="divider"></div>
  <section id="about" class="mx-auto max-w-6xl px-4 py-16">
    <h2 class="reveal text-3xl font-semibold tracking-tight md:text-4xl">Для кого</h2>
    <p class="reveal mt-2 max-w-3xl text-black/60">Курс рассчитан на специалистов, которым нужен прикладной навык — от оцифровки до готовой детали.</p>
    <div id="audienceGrid" class="mt-8 grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4"></div>
    <p class="mt-3 text-xs text-black/60">Не нашли себя? <a href="#apply" class="underline underline-offset-2">Напишите нам</a> — подскажем, подойдёт ли программа под ваши задачи.</p>
    <div class="mt-4 rounded-2xl border border-black/10 bg-amber-50/40 p-4 text-sm">
      <div class="font-medium">Предварительные требования</div>
      <p class="mt-1 text-black/70">Слушатели должны владеть базовыми навыками CAD-проектирования и быть знакомыми с основами теории машиностроения.</p>
    </div>
  </section>
  <div class="divider"></div>
  <section id="program" class="mx-auto max-w-6xl px-4 py-16">
    <h2 class="reveal text-3xl font-semibold tracking-tight md:text-4xl">Календарно-тематический план</h2>
    <p class="reveal mt-2 max-w-3xl text-black/60">48 часов. Теория ровно столько, сколько нужно для практики.</p>
    <div id="startCalendar" class="mb-4 overflow-hidden rounded-2xl border border-black/10"></div>
    <div id="programRoot" class="relative rounded-2xl border border-black/10"></div>
    <div class="mt-6 grid gap-4 md:grid-cols-3">
      <div class="rounded-2xl border border-black/10 p-4"><div class="text-sm opacity-60">Стоимость</div><div class="mt-1 text-2xl font-semibold" id="leadPrice"></div></div>
      <div class="rounded-2xl border border-black/10 p-4"><div class="text-sm opacity-60">Сроки и режим</div><div class="mt-1 font-medium" id="leadDuration"></div></div>
      <div class="rounded-2xl border border-black/10 p-4"><div class="text-sm opacity-60">Группа</div><div class="mt-1 font-medium" id="leadSeats"></div></div>
    </div>
    <p class="mt-4 text-xs opacity-70">Индустриальный партнёр курса — <span class="font-medium">STEP_3D</span>.</p>
  </section>
  <div class="divider"></div>
  <section id="team" class="mx-auto max-w-6xl px-4 py-16">
    <h2 class="reveal text-3xl font-semibold tracking-tight md:text-4xl">Команда</h2>
    <p class="reveal mt-2 max-ww-3xl text-black/60">РГСУ — один из ведущих центров компетенций по реверсивному инжинирингу. Среди преподавателей — чемпионы и эксперты WorldSkills/BRICS.</p>
    <div class="mt-8 grid gap-4 md:grid-cols-3">
      <div class="relative rounded-2xl border border-black/10 p-4">
        <div class="text-sm opacity-60">Куратор</div>
        <div class="mt-1 font-medium">Рекут Алексей Валерьевич</div>
        <p class="mt-2 text-sm opacity-70">Один из разработчиков первого ФГОС по аддитивным технологиям. Главный эксперт и тренер сборной России (WorldSkills, 2017–2022) по компетенции «Реверсивный инжиниринг».</p>
      </div>
      <div class="relative rounded-2xl border border-black/10 p-4">
        <div class="text-sm opacity-60">Преподаватель</div>
        <div class="mt-1 font-medium">Ганьшин Владимир Константинович</div>
        <p class="mt-2 text-sm opacity-70">Практик STEP_3D, автор учебных программ и кейсов обратного инжиниринга.</p>
      </div>
      <div class="relative rounded-2xl border border-black/10 p-4">
        <div class="text-sm opacity-60">Преподаватель</div>
        <div class="mt-1 font-medium">Понкратова Христина</div>
        <p class="mt-2 text-sm opacity-70">Специалист по 3D-сканированию и аддитивному производству. Ведёт практикумы и наставничество.</p>
      </div>
    </div>
  </section>
  <div class="divider"></div>
  <section id="apply" class="mx-auto max-w-6xl px-4 py-16">
    <h2 class="reveal text-3xl font-semibold tracking-tight md:text-4xl">Поступить на курс</h2>
    <p class="reveal mt-2 max-w-3xl text-black/60">Оставьте заявку — менеджер свяжется с вами и уточнит детали (наличие мест, график, документы).</p>
    <form id="applyForm" class="mt-8 rounded-2xl border border-black/10 p-4" novalidate>
      <div class="grid gap-4 md:grid-cols-2">
        <label class="flex flex-col gap-1 text-sm">
          Имя и фамилия
          <input name="name" autocomplete="name" required placeholder="Иван Иванов"
                 class="rounded-xl border border-black/10 px-3 py-2 outline-none focus-visible:ring-2 focus-visible:ring-black/30"/>
          <span class="hidden text-xs text-red-600" data-err="name"></span>
        </label>
        <label class="flex flex-col gap-1 text-sm">
          Электронная почта
          <input name="email" type="email" autocomplete="email" required placeholder="name@example.com"
                 class="rounded-xl border border-black/10 px-3 py-2 outline-none focus-visible:ring-2 focus-visible:ring-black/30"/>
          <span class="hidden text-xs text-red-600" data-err="email"></span>
        </label>
        <label class="md:col-span-2 flex flex-col gap-1 text-sm">
          Комментарий
          <textarea name="comment" rows="4" placeholder="Кратко о целях и опыте"
                    class="rounded-xl border border-black/10 px-3 py-2 outline-none focus-visible:ring-2 focus-visible:ring-black/30"></textarea>
        </label>
        <label class="md:col-span-2 flex items-start gap-2 text-sm">
          <input name="agree" type="checkbox" class="mt-1 h-4 w-4 rounded border-black/20 outline-none focus-visible:ring-2 focus-visible:ring-black/30"/>
          <span>Согласен(а) на обработку персональных данных и условия политики конфиденциальности.</span>
        </label>
        <span class="hidden text-xs text-red-600 md:col-span-2" data-err="agree"></span>
      </div>
      <div class="mt-4 flex flex-wrap items-center gap-3">
        <button type="submit" id="submitBtn" disabled
                class="cursor-not-allowed rounded-xl bg-black/30 px-4 py-2 text-white outline-none transition focus-visible:ring-2 focus-visible:ring-black/30">Отправить заявку</button>
        <span class="inline-flex items-center gap-2 rounded-full border border-black/10 px-3 py-1 text-sm">Стоимость: <span class="font-medium" id="leadPriceInline"></span></span>
        <span class="inline-flex items-center gap-2 rounded-full border border-black/10 px-3 py-1 text-sm">Адрес: <span class="font-medium">Москва, ул. Вильгельма Пика, д. 4, к. 8 (технопарк РГСУ)</span></span>
      </div>
    </form>
    <div class="mt-4 space-y-2 text-xs opacity-70">
      <p>Нажимая кнопку «Отправить заявку», вы даёте <span class="underline">согласие на обработку персональных данных</span> и подтверждаете ознакомление с политикой конфиденциальности.</p>
      <p>Индустриальный партнёр курса — <span class="font-medium">STEP_3D</span>. По всем вопросам можно писать в Telegram: <a class="underline" href="https://t.me/step_3d_mngr" target="_blank" rel="noreferrer">@step_3d_mngr</a>.</p>
      <p>По предварительной договорённости (<span class="font-medium">от 6 человек</span>) мы можем согласовать и утвердить удобные для вашей команды даты старта и расписания.</p>
    </div>
    <div class="mt-6">
      <div class="text-sm opacity-60">Полезные ссылки</div>
      <div class="mt-4 flex flex-wrap gap-3">
        <a href="https://rgsu.net" target="_blank" rel="noreferrer" class="rounded-xl border border-black/10 px-4 py-2 transition hover:bg-black hover:text-white">Сайт технопарка РГСУ</a>
        <a href="https://web.telegram.org/k/#@STEP_3D_Lab" target="_blank" rel="noreferrer" class="rounded-xl border border-black/10 px-4 py-2 transition hover:bg-black hover:text-white">Портфолио и новости (Telegram)</a>
        <a href="https://t.me/step_3d_mngr" target="_blank" rel="noreferrer" class="rounded-xl border border-black/10 px-4 py-2 transition hover:bg-black hover:text-white">Контакт в Telegram: @step_3d_mngr</a>
      </div>
    </div>
  </section>
  <div id="stickyCta" class="fixed inset-x-0 bottom-3 z-[55] px-3 sm:hidden transition opacity-100">
    <div class="mx-auto flex max-w-6xl items-center justify-between rounded-2xl border border-black/10 bg-white/90 px-3 py-2 shadow-lg backdrop-blur">
      <span class="text-sm">Стоимость: <span class="font-semibold" id="leadPriceMobile"></span></span>
      <a href="#apply" class="rounded-xl bg-black px-3 py-1.5 text-white">Записаться</a>
    </div>
  </div>
  <footer class="border-t border-black/10 py-10">
    <div class="mx-auto max-w-6xl px-4 text-sm opacity-70">© <span id="year"></span> РГСУ · Курс «Реверсивный инжиниринг и АТ». Все права защищены.</div>
  </footer>
  <script>
const benefits = [
  'Разработка КД и 3D-моделей по существующим деталям',
  'Оперативный ремонт и изготовление запчастей на АТ',
  'Снижение издержек с помощью собственной оснастки',
];
const audience = [
  'Инженеры-конструкторы и технологи',
  'Операторы ЧПУ',
  'Студенты техвузов, молодые учёные, преподаватели',
  'Промышленные дизайнеры',
];
const modules = [
  { day: '01 (Пн)', blocks: [
      { title: 'Лекция: Реверсивный инжиниринг и аддитивные технологии в производстве. ОТ и ТБ. Кейсы РГСУ (Hi-Tech, Ростех, Северсталь, СИБУР, ЕВРАЗ)', hours: '2 ч (1 лк + 0,5 сем + 0,5 кт)', control: 'Устный опрос' },
      { title: 'Мастер-класс #1: CAD/CAM-моделирование мастер-моделей и метаформ (T-FLEX CAD)', hours: '—', control: 'Зачёт' },
      { title: 'Прак-работа #1: Выбор средства оцифровки и оснастки. Калибровка сканера (RangeVision Spectrum)', hours: '2 ч', control: '—' },
      { title: 'Прак-работа #2: 3D-сканирование на стационарном сканере', hours: '4 ч', control: '—' },
    ] },
  { day: '02 (Вт)', blocks: [
      { title: 'Прак-работа #3: Реверс в Geomagic Design X (базовые функции)', hours: '4 ч', control: '—' },
      { title: 'Мастер-класс #2: Основы 3D-печати (FDM, PICASO 3D). От индустриального партнёра', hours: '2 ч (0,5 лк + 1 пр + 0,5 кт)', control: '—' },
      { title: 'Прак-работа #4: Подготовка моделей к FDM/DLP/SLA. Запуск печати', hours: '2 ч', control: '—' },
    ] },
  { day: '03 (Ср)', blocks: [
      { title: 'Мастер-класс #3: 3D-сканирование ручным оптическим сканером (Artec Eva)', hours: '2 ч (0,5 лк + 1 пр + 0,5 кт)', control: 'Устный опрос' },
      { title: 'Прак-работа #5: Geomagic Design X (продвинутые функции)', hours: '6 ч (1 лк + 5 пр)', control: 'Зачёт' },
    ] },
  { day: '04 (Чт)', blocks: [
      { title: 'Мастер-класс #4: Основы DLP/SLA-печати. От индустриального партнёра', hours: '2 ч (0,5 лк + 1 пр + 0,5 кт)', control: 'Устный опрос' },
      { title: 'Прак-работа #6: Подготовка к FDM/DLP/SLA. Запуск печати', hours: '2 ч (0,5 лк + 1 пр + 0,5 кт)', control: 'Зачёт' },
      { title: 'Отработка навыков (сканирование/реверс/печать) — свободный формат', hours: '4 ч', control: '—' },
    ] },
  { day: '05 (Пт)', blocks: [
      { title: 'Экзамен (ДЭ): задание в формате International High-Tech Competition (компетенция «Реверсивный инжиниринг»)', hours: '16 ч (2 лк + 12 пр + 2 кт)', control: 'Экзамен (ДЭ)' },
    ] },
  { day: '06 (Сб)', blocks: [] },
];
const lead = {
  price: '68\u202f000 ₽',
  duration: '48 часов (1 неделя, пн-сб 09:00—18:00)',
  seats: '6–12 человек в группе',
  venue: 'Москва, ул. Вильгельма Пика, д. 4, к. 8 (технопарк РГСУ)',
};
const gallery = [
  { id: 1, alt: '3D-сканирование — стационарный стенд', src: 'https://images.unsplash.com/photo-1581091014534-7b8c6e7d0f5b?q=80&w=1400&auto=format&fit=crop' },
  { id: 2, alt: 'Реверсивный инжиниринг — CAD-модель', src: 'https://images.unsplash.com/photo-1581091215367-59ab6b77aa5f?q=80&w=1400&auto=format&fit=crop' },
  { id: 3, alt: '3D-печать — послойное построение', src: 'https://images.unsplash.com/photo-1581092921461-eab62e97a780?q=80&w=1400&auto=format&fit=crop' },
];
const COURSE_START = new Date('2025-10-20T09:00:00+03:00');
const $ = (sel, el=document) => el.querySelector(sel);
const $$ = (sel, el=document) => Array.from(el.querySelectorAll(sel));
const formatShortDateRu = (d) => new Intl.DateTimeFormat('ru-RU',{ day:'2-digit', month:'short'}).format(d).replace('.', '');
function parseHours(str){
  try{
    if (typeof str !== 'string') return 0;
    const lower = str.toLowerCase();
    const pos = lower.indexOf('ч');
    if (pos === -1) return 0;
    let num = '';
    for (let i = pos - 1; i >= 0; i--) {
      const ch = lower[i];
      if ((ch >= '0' && ch <= '9') || ch === ',' || ch === '.') num = ch + num;
      else if (num) break;
    }
    const val = parseFloat(num.replace(',', '.'));
    return Number.isFinite(val) ? Math.round(val * 10) / 10 : 0;
  } catch { return 0 }
}
function activityTypeFromTitle(t=''){
  const s = String(t).toLowerCase();
  if (s.startsWith('лекция')) return 'lecture';
  if (s.startsWith('прак')) return 'practice';
  if (s.startsWith('экзамен')) return 'exam';
  if (s.startsWith('мастер')) return 'workshop';
  return 'lecture';
}
function getBlocksSummary(blocks){
  const typeCounts = { lecture:0, practice:0, workshop:0, exam:0 };
  let hours = 0;
  for (const b of blocks || []){
    const t = activityTypeFromTitle(b?.title || '');
    typeCounts[t]++;
    hours += parseHours(b?.hours || '');
  }
  return { hours: Math.round(hours*10)/10, typeCounts };
}
function createPill(text, tone='neutral'){
  const tones = {
    neutral: 'border-black/10 bg-white/60 text-current',
    lecture: 'border-sky-300/40 bg-sky-50 text-sky-900',
    practice: 'border-emerald-300/40 bg-emerald-50 text-emerald-900',
    workshop: 'border-amber-300/40 bg-amber-50 text-amber-900',
    exam: 'border-rose-300/40 bg-rose-50 text-rose-900',
  };
  const span = document.createElement('span');
  span.className = `inline-flex items-center gap-2 rounded-full border px-3 py-1 text-sm backdrop-blur ${tones[tone] || tones.neutral}`;
  span.textContent = text;
  return span;
}
function renderBenefits(){ const root = $('#benefits'); ['a','b']; benefits.forEach(b => root.appendChild(createPill(b))); }
function renderIcon(name){
  switch(name){
    case 'clock': return '<svg viewBox="0 0 24 24" class="h-full w-full"><circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="1.5"/><path d="M12 7v6l4 2" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>';
    case 'group': return '<svg viewBox="0 0 24 24" class="h-full w-full"><circle cx="8" cy="10" r="3" stroke="currentColor" fill="none" stroke-width="1.5"/><circle cx="16" cy="10" r="3" stroke="currentColor" fill="none" stroke-width="1.5"/><path d="M2 18c1.5-3 4-4 6-4s4.5 1 6 4" stroke="currentColor" fill="none" stroke-width="1.5"/></svg>';
    case 'workshop': return '<svg viewBox="0 0 24 24" class="h-full w-full"><rect x="3" y="6" width="18" height="12" rx="2" ry="2" stroke="currentColor" fill="none" stroke-width="1.5"/><path d="M3 10h18" stroke="currentColor" stroke-width="1.5"/><circle cx="8" cy="14" r="1.5" fill="currentColor"/><circle cx="12" cy="14" r="1.5" fill="currentColor"/><circle cx="16" cy="14" r="1.5" fill="currentColor"/></svg>';
    case 'scan3d': return '<svg viewBox="0 0 24 24" class="h-full w-full"><rect x="4" y="4" width="16" height="16" rx="2" ry="2" stroke="currentColor" fill="none" stroke-width="1.5"/><path d="M5 9h14" stroke="currentColor" stroke-width="1.5"/><path d="M5 15h14" stroke="currentColor" stroke-width="1.5"/></svg>';
    case 'engineer': return '<svg viewBox="0 0 24 24" class="h-full w-full"><circle cx="12" cy="7" r="3" stroke="currentColor" fill="none" stroke-width="1.5"/><path d="M5 20c1-4 5-5 7-5s6 1 7 5" stroke="currentColor" fill="none" stroke-width="1.5"/><path d="M9 7h6" stroke="currentColor" stroke-width="1.5"/></svg>';
    case 'cnc': return '<svg viewBox="0 0 24 24" class="h-full w-full"><rect x="4" y="4" width="16" height="10" rx="2" stroke="currentColor" fill="none" stroke-width="1.5"/><path d="M8 18h8" stroke="currentColor" stroke-width="1.5"/><path d="M12 8v4" stroke="currentColor" stroke-width="1.5"/></svg>';
    case 'student': return '<svg viewBox="0 0 24 24" class="h-full w-full"><path d="M12 4l8 4-8 4-8-4 8-4z" stroke="currentColor" fill="none" stroke-width="1.5"/><path d="M6 12v3c2 2 10 2 12 0v-3" stroke="currentColor" fill="none" stroke-width="1.5"/></svg>';
    case 'designer': return '<svg viewBox="0 0 24 24" class="h-full w-full"><path d="M4 20l6-2 10-10-4-4L6 14l-2 6z" stroke="currentColor" fill="none" stroke-width="1.5"/></svg>';
    case 'lecture': return '<svg viewBox="0 0 24 24" class="h-full w-full"><rect x="3" y="5" width="18" height="12" rx="2" ry="2" stroke="currentColor" fill="none" stroke-width="1.5"/><path d="M7 9h10M7 12h6" stroke="currentColor" stroke-width="1.5"/></svg>';
    case 'practice': return '<svg viewBox="0 0 24 24" class="h-full w-full"><path d="M4 18h16" stroke="currentColor" stroke-width="1.5"/><rect x="6" y="6" width="12" height="8" rx="1.5" stroke="currentColor" fill="none" stroke-width="1.5"/><path d="M9 14v4M15 14v4" stroke="currentColor" stroke-width="1.5"/></svg>';
    case 'exam': return '<svg viewBox="0 0 24 24" class="h-full w-full"><rect x="4" y="4" width="12" height="16" rx="2" ry="2" stroke="currentColor" fill="none" stroke-width="1.5"/><path d="M20 7l-5 5-3-3" stroke="currentColor" stroke-width="1.5" fill="none"/></svg>';
    default: return '';
  }
}
function renderStats(){
  const stats = [
    { k: '48 ч', v: 'интенсив', icon: 'clock' },
    { k: '6–12', v: 'в группе', icon: 'group' },
    { k: '4', v: 'мастер-класса', icon: 'workshop' },
    { k: '3D', v: 'скан/реверс/печать', icon: 'scan3d' },
  ];
  const root = $('#stats');
  stats.forEach(s => {
    const card = document.createElement('div');
    card.className = 'group relative overflow-hidden rounded-2xl border border-black/10 p-4 text-center hover:shadow-md';
    card.innerHTML = `
      <div class="mx-auto h-7 w-7 text-black/80">${renderIcon(s.icon)}</div>
      <div class="mt-2 text-2xl font-semibold tracking-tight">${s.k}</div>
      <div class="text-[10px] uppercase tracking-[.15em] text-black/50">${s.v}</div>
      <span aria-hidden class="pointer-events-none absolute -right-5 -top-5 h-16 w-16 rounded-full border border-black/10"></span>
    `;
    root.appendChild(card);
  });
}
function initCarousel(){
  const root = $('#carousel');
  let idx = 0, zoom = 1, origin = '50% 50%', touchStartX = null;
  const img = document.createElement('img');
  img.draggable = false;
  img.className = 'absolute inset-0 h-full w-full object-cover transition-opacity duration-300';
  root.appendChild(img);
  const prevBtn = document.createElement('button');
  prevBtn.setAttribute('aria-label','Предыдущее фото');
  prevBtn.className = 'pointer-events-auto grid h-9 w-9 place-items-center rounded-full bg-white/70 text-black shadow transition hover:bg-white absolute left-2 top-1/2 -translate-y-1/2';
  prevBtn.textContent = '‹';
  const nextBtn = document.createElement('button');
  nextBtn.setAttribute('aria-label','Следующее фото');
  nextBtn.className = 'pointer-events-auto grid h-9 w-9 place-items-center rounded-full bg-white/70 text-black shadow transition hover:bg-white absolute right-2 top-1/2 -translate-y-1/2';
  nextBtn.textContent = '›';
  root.appendChild(prevBtn); root.appendChild(nextBtn);
  const dots = document.createElement('div');
  dots.className = 'pointer-events-none absolute bottom-2 left-0 right-0 flex items-center justify-center gap-2';
  root.appendChild(dots);
  function render(){
    const item = gallery[idx];
    img.style.opacity = 0;
    setTimeout(()=>{
      img.src = item.src; img.alt = item.alt || ''; img.style.opacity = 1;
      img.style.transform = `scale(${zoom})`;
      img.style.transformOrigin = origin;
    }, 100);
    dots.innerHTML = '';
    gallery.forEach((_, i)=>{
      const b = document.createElement('button');
      b.className = 'pointer-events-auto dot ' + (i===idx ? 'w-6 bg-black' : 'w-3 bg-black/40');
      b.setAttribute('aria-label', `Слайд ${i+1}`);
      b.onclick = ()=>{ idx=i; zoom=1; render(); };
      dots.appendChild(b);
    });
  }
  function go(d){ idx = (idx + d + gallery.length) % gallery.length; zoom=1; render(); }
  prevBtn.onclick = ()=> go(-1);
  nextBtn.onclick = ()=> go(1);
  window.addEventListener('keydown', (e)=>{
    if (e.key === 'ArrowLeft') go(-1);
    if (e.key === 'ArrowRight') go(1);
  });
  root.addEventListener('dblclick', (e)=>{
    const rect = root.getBoundingClientRect();
    const x = ((e.clientX ?? rect.width/2) - rect.left) / rect.width * 100;
    const y = ((e.clientY ?? rect.height/2) - rect.top) / rect.height * 100;
    origin = `${x}% ${y}%`;
    zoom = zoom > 1 ? 1 : 1.6;
    render();
  });
  root.addEventListener('touchstart', (e)=>{ touchStartX = e.touches[0].clientX; });
  root.addEventListener('touchend', (e)=>{
    if (touchStartX == null) return;
    const dx = e.changedTouches[0].clientX - touchStartX;
    if (Math.abs(dx) > 40) go(dx > 0 ? -1 : 1);
    touchStartX = null;
  });
  render();
}
function renderAudience(){
  const root = $('#audienceGrid');
  const icons = ['engineer','cnc','student','designer'];
  audience.forEach((a,i)=>{
    const card = document.createElement('div');
    card.className = 'group h-full rounded-2xl border border-black/10 p-5 hover:shadow-md';
    card.innerHTML = `
      <div class="flex h-full items-start gap-3">
        <span aria-hidden class="mt-0.5 h-6 w-6 text-black/80 md:h-7 md:w-7">${renderIcon(icons[i % 4])}</span>
        <div class="flex-1">
          <div class="text-[10px] uppercase tracking-[.15em] text-black/50">Аудитория</div>
          <div class="mt-0.5 text-[15px] font-medium leading-snug md:text-base line-clamp-2" title="${a}">${a}</div>
        </div>
      </div>`;
    root.appendChild(card);
  });
}
function renderStartCalendar(){
  const days = 6;
  const labels = ['Пн','Вт','Ср','Чт','Пт','Сб'];
  const arr = new Array(days).fill(0).map((_,i)=> new Date(COURSE_START.getTime()+i*86400000));
  const root = $('#startCalendar');
  const head = `<div class="grid grid-cols-6 bg-white/60 text-xs">${labels.map(l=>`<div class="px-3 py-2 text-center font-medium text-black/60">${l}</div>`).join('')}</div>`;
  const body = `<div class="grid grid-cols-6 bg-white/30 text-sm">${arr.map(d=>`<div class="px-3 py-3 text-center"><div class="inline-flex min-w-[3rem] items-center justify-center rounded-full border border-black/10 px-3 py-1">${formatShortDateRu(d)}</div></div>`).join('')}</div>`;
  root.innerHTML = head + body;
}
function renderProgram(){
  const root = $('#programRoot');
  let view = 'full';
  let openDay = '01 (Пн)';
  const railTone = (t)=> ({ lecture: 'from-sky-400/40', practice: 'from-emerald-400/40', workshop: 'from-amber-400/50', exam: 'from-rose-400/40', }[t] || 'from-black/20');
  const head = document.createElement('div');
  head.className = 'flex items中心 justify-between gap-3 border-b border-black/10 p-3'.replace('центр','center');
  head.innerHTML = `
    <div class="text-sm opacity-60">Режим просмотра</div>
    <div class="flex items-center gap-2">
      <button data-view="full" class="rounded-lg px-3 py-1 text-sm bg-black text-white">подробно</button>
      <button data-view="compact" class="rounded-lg px-3 py-1 text-sm border border-black/10 hover:bg-neutral-50">кратко</button>
    </div>`;
  root.appendChild(head);
  const tabsWrap = document.createElement('div');
  tabsWrap.className = 'sticky top-16 z-20 border-b border-black/10 bg-white/80 backdrop-blur';
  tabsWrap.innerHTML = '<div class="overflow-x-auto px-3 py-2"><div class="flex items-center gap-2" id="dayTabs"></div></div>';
  root.appendChild(tabsWrap);
  const body = document.createElement('div'); body.id = 'programDays'; root.appendChild(body);
  function renderTabs(){
    const tabs = $('#dayTabs'); tabs.innerHTML = '';
    modules.forEach((m,i)=>{
      const isActive = openDay === m.day;
      const d = new Date(COURSE_START.getTime()+i*86400000);
      const s = getBlocksSummary(m.blocks);
      const btn = document.createElement('button');
      btn.className = 'relative rounded-full px-3 py-1.5 text-sm transition ' + (isActive ? 'bg-black text-white' : 'border border-black/10 bg-white hover:bg-neutral-50');
      btn.innerHTML = `
        <span class="font-medium">${String(i+1).padStart(2,'0')}</span>
        <span class="mx-1 opacity-60">·</span>
        <span class="opacity-80">${formatShortDateRu(d)}</span>
        ${s.hours>0 ? `<span class="ml-2 rounded-full bg-black/10 px-2 text-xs">${s.hours} ч</span>` : ''}
        <span class="ml-2 inline-flex gap-1 align-middle">
          ${s.typeCounts.lecture>0 ? '<span title="Лекции" class="h-2 w-2 rounded-full bg-sky-400/70"></span>' : ''}
          ${s.typeCounts.practice>0 ? '<span title="Практика" class="h-2 w-2 rounded-full bg-emerald-400/70"></span>' : ''}
          ${s.typeCounts.workshop>0 ? '<span title="Мастер-класс" class="h-2 w-2 rounded-full bg-amber-400/80"></span>' : ''}
          ${s.typeCounts.exam>0 ? '<span title="Экзамен" class="h-2 w-2 rounded-full bg-rose-400/70"></span>' : ''}
        </span>`;
      btn.onclick = ()=>{ openDay = m.day; renderTabs(); renderDays(); };
      tabs.appendChild(btn);
    });
  }
  function renderDays(){
    body.innerHTML = '';
    modules.forEach((m,i)=>{
      const panel = document.createElement('div');
      panel.className = 'relative z-10 border-b border-black/10';
      const summary = getBlocksSummary(m.blocks);
      const expanded = openDay === m.day;
      panel.innerHTML = `
        <button class="group flex w-full items-center justify-between gap-4 p-4 text-left hover:bg-neutral-50" aria-expanded="${expanded}">
          <div class="flex items-center gap-3">
            <span class="inline-flex h-7 w-7 items-center justify-center rounded-full border border-black/10 text-xs">${String(i+1).padStart(2,'0')}</span>
            <span class="font-medium">${m.day} · ${formatShortDateRu(new Date(COURSE_START.getTime() + i*86400000))}</span>
          </div>
          <div class="hidden items-center gap-2 md:flex">
            ${summary.hours>0 ? `<span class="rounded-full border border-black/10 px-2 py-0.5 text-xs">⏱ ${summary.hours} ч</span>` : ''}
            ${summary.typeCounts.lecture>0 ? `<span class="rounded-full border border-sky-200 bg-sky-50 px-2 py-0.5 text-xs text-sky-800">Л ${summary.typeCounts.lecture}</span>` : ''}
            ${summary.typeCounts.practice>0 ? `<span class="rounded-full border border-emerald-200 bg-emerald-50 px-2 py-0.5 text-xs text-emerald-800">П ${summary.typeCounts.practice}</span>` : ''}
            ${summary.typeCounts.workshop>0 ? `<span class="rounded-full border border-amber-200 bg-amber-50 px-2 py-0.5 text-xs text-amber-800">М ${summary.typeCounts.workshop}</span>` : ''}
            ${summary.typeCounts.exam>0 ? `<span class="rounded-full border border-rose-200 bg-rose-50 px-2 py-0.5 text-xs text-rose-800">Э ${summary.typeCounts.exam}</span>` : ''}
          </div>
          <span class="text-xs opacity-60">${expanded ? '⌃' : '⌄'}</span>
        </button>
        <div class="overflow-hidden transition-[grid-template-rows,opacity] duration-300 ease-out" style="grid-template-rows: ${expanded ? '1fr' : '0fr'};">
          <div class="grid min-h-0 ${view==='full' ? 'md:grid-cols-2' : 'md:grid-cols-3'} gap-4 p-4">
            ${m.blocks.length === 0 ? '<div class="rounded-xl border border-black/10 p-4 text-sm opacity-60">Зарезервировано под защиту проектов/экскурсию/подведение итогов.</div>' : ''}
            ${m.blocks.map((b,idx)=>{
              const t = activityTypeFromTitle(b.title);
              const icon = t === 'lecture' ? 'lecture' : t === 'practice' ? 'practice' : t === 'exam' ? 'exam' : 'workshop';
              return `
                <div class="relative overflow-hidden rounded-xl border border-black/10 p-4 shadow-sm hover:shadow-md hover-shimmer">
                  <span aria-hidden class="absolute left-0 top-0 h-full w-0.5 bg-gradient-to-b ${railTone(t)} to-transparent"></span>
                  <div class="flex items-start gap-3">
                    <div class="grid h-8 w-8 place-items-center rounded-lg border border-black/10 bg-white">
                      <span class="h-5 w-5 text-black/80">${renderIcon(icon)}</span>
                    </div>
                    <div class="flex-1">
                      <div class="font-medium leading-snug ${view==='compact' ? 'line-clamp-2' : ''}">${b.title}</div>
                      <div class="mt-2 flex flex-wrap items-center gap-2 text-xs opacity-70">
                        ${b.hours !== '—' ? createPill('⏱ ' + b.hours).outerHTML : ''}
                        ${b.control !== '—' ? createPill('✔ ' + b.control).outerHTML : ''}
                        ${createPill('Тип: ' + ({lecture:'Лекция',practice:'Практика',workshop:'Мастер-класс',exam:'Экзамен'})[t], t).outerHTML}
                      </div>
                    </div>
                  </div>
                </div>`
            }).join('')}
          </div>
        </div>`;
      const btn = panel.querySelector('button');
      btn.addEventListener('click', ()=>{ openDay = (openDay === m.day ? '' : m.day); renderDays(); });
      body.appendChild(panel);
    });
  }
  head.querySelectorAll('button[data-view]').forEach(b=>{
    b.addEventListener('click', ()=>{
      view = b.getAttribute('data-view');
      head.querySelectorAll('button[data-view]').forEach(x=>{
        if (x === b) { x.classList.add('bg-black','text-white'); x.classList.remove('border','border-black/10','hover:bg-neutral-50'); }
        else { x.classList.remove('bg-black','text-white'); x.classList.add('border','border-black/10'); }
      });
      renderDays();
    });
  });
  renderTabs();
  renderDays();
}
function initCountdown(){
  const el = document.getElementById('countdown');
  function tick(){
    const now = Date.now();
    const t = COURSE_START.getTime();
    const diff = Math.max(0, t - now);
    const d = Math.floor(diff/86400000);
    const h = Math.floor((diff%86400000)/3600000);
    const m = Math.floor((diff%3600000)/60000);
    const s = Math.floor((diff%60000)/1000);
    el.textContent = `${d}д ${h}ч ${m}м ${s}с`;
  }
  tick(); setInterval(tick, 1000);
}
function initForm(){
  const form = document.getElementById('applyForm');
  const submitBtn = document.getElementById('submitBtn');
  const storageKey = 'applyForm';
  try{
    const raw = localStorage.getItem(storageKey);
    if (raw) {
      const parsed = JSON.parse(raw);
      ['name','email','comment','agree'].forEach(k=>{
        if (k in parsed && form.elements[k]) {
          if (k==='agree') form.elements[k].checked = !!parsed[k];
          else form.elements[k].value = parsed[k];
        }
      });
    }
  } catch {}
  function showError(name, msg){
    const err = form.querySelector(`[data-err="${name}"]`);
    if (!err) return;
    if (msg){ err.textContent = msg; err.classList.remove('hidden'); }
    else { err.textContent = ''; err.classList.add('hidden'); }
    const input = form.elements[name];
    if (input){
      if (msg) input.classList.add('border-red-400');
      else input.classList.remove('border-red-400');
    }
  }
  function validate(silent=false){
    const name = form.elements.name.value.trim();
    const email = form.elements.email.value.trim();
    const agree = form.elements.agree.checked;
    let ok = true;
    if (name.split(/\s+/).length < 2){ ok=false; if(!silent) showError('name','Укажите имя и фамилию'); } else if(!silent) showError('name', '');
    if (!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(email)){ ok=false; if(!silent) showError('email','Проверьте формат e-mail'); } else if(!silent) showError('email','');
    if (!agree){ ok=false; if(!silent) showError('agree','Нужно согласие на обработку данных'); } else if(!silent) showError('agree','');
    submitBtn.disabled = !ok;
    submitBtn.className = 'rounded-xl px-4 py-2 text-white outline-none transition focus-visible:ring-2 focus-visible:ring-black/30 ' + (ok ? 'bg-black hover:opacity-90' : 'bg-black/30 cursor-not-allowed');
    return ok;
  }
  form.addEventListener('input', ()=>{
    const state = {
      name: form.elements.name.value,
      email: form.elements.email.value,
      comment: form.elements.comment.value,
      agree: form.elements.agree.checked
    };
    try{ localStorage.setItem(storageKey, JSON.stringify(state)); } catch {}
    validate(true);
  });
  form.addEventListener('blur', (e)=>{ if (e.target && e.target.name) validate(false); }, true);
  form.addEventListener('submit', (e)=>{
    e.preventDefault();
    if (!validate(false)) return;
    alert('Заявка отправлена! Мы свяжемся с вами.');
    form.reset();
    try{ localStorage.removeItem(storageKey); } catch {}
    validate(true);
  });
  validate(true);
}
function initObservers(){
  const links = Array.from(document.querySelectorAll('#navLinks a'));
  const ids = ['top','about','program','team','apply'];
  const sections = ids.map(id=>document.getElementById(id)).filter(Boolean);
  const cta = document.getElementById('stickyCta');
  const io = new IntersectionObserver((entries)=>{
    entries.forEach(entry=>{
      if (entry.isIntersecting){
        const id = entry.target.id;
        links.forEach(a=>{
          a.classList.toggle('text-black', a.dataset.nav===id);
          a.classList.toggle('opacity-70', a.dataset.nav!==id);
        });
        if (id === 'apply'){ cta.style.opacity = '0'; cta.style.pointerEvents = 'none'; }
        else { cta.style.opacity = '1'; cta.style.pointerEvents = 'auto'; }
      }
    });
  }, { rootMargin: '-40% 0px -55% 0px', threshold: [0, .2, .5, 1] });
  sections.forEach(s=> io.observe(s));
  const reveal = new IntersectionObserver((entries)=>{
    entries.forEach(e=>{ if (e.isIntersecting){ e.target.classList.add('revealed'); reveal.unobserve(e.target); } });
  }, { threshold: 0.15 });
  Array.from(document.querySelectorAll('.reveal')).forEach(el=> reveal.observe(el));
}
function initScrollBar(){
  const bar = document.getElementById('scrollbar');
  function onScroll(){
    const h = document.documentElement;
    const scrolled = (h.scrollTop) / ((h.scrollHeight - h.clientHeight) || 1);
    bar.style.transform = `scaleX(${Math.max(0, Math.min(1, scrolled))})`;
  }
  onScroll();
  document.addEventListener('scroll', onScroll, { passive: true });
  window.addEventListener('resize', onScroll);
}
function renderLead(){
  document.getElementById('leadPrice').textContent = lead.price;
  document.getElementById('leadDuration').textContent = lead.duration;
  document.getElementById('leadSeats').textContent = lead.seats;
  document.getElementById('leadPriceInline').textContent = lead.price;
  document.getElementById('leadPriceMobile').textContent = lead.price;
}
function setYear(){ document.getElementById('year').textContent = new Date().getFullYear(); }
renderBenefits();
renderStats();
initCarousel();
renderAudience();
renderStartCalendar();
renderProgram();
initCountdown();
initForm();
initObservers();
initScrollBar();
renderLead();
setYear();
</script>
</body>
</html>
